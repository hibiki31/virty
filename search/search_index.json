{"config":{"lang":["ja"],"separator":"[\\s\\-\u3000\u3001\u3002\uff0c\uff0e]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Home","text":"<p>Virty\u306f\u3001\u4f4e\u30b3\u30b9\u30c8\u3067\u306e\u904b\u7528\u3092\u76ee\u7684\u3068\u3057\u305fKVM\u7ba1\u7406\u7528\u306eWeb\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u3059\u3002\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u3068\u3057\u3066\u3001SSH\u7d4c\u7531\u3067Libvirt API\u3084Ansible\u3092\u5b9f\u884c\u3057\u3001\u30ce\u30fc\u30c9\u306e\u7ba1\u7406\u3092\u884c\u3044\u307e\u3059\u3002SSH\u63a5\u7d9a\u304c\u53ef\u80fd\u306aLinux\u30ce\u30fc\u30c9\u306b\u5bfe\u3057\u3066\u3001Web\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089\u30d7\u30ed\u30d3\u30b8\u30e7\u30cb\u30f3\u30b0\u3092\u5b9f\u65bd\u3067\u304d\u307e\u3059\u3002</p> <p></p> <p>\u4ed6\u306e\u30d7\u30ec\u30d3\u30e5\u30fc\u30a4\u30e1\u30fc\u30b8(v5.0.0)</p>"},{"location":"#_1","title":"\u514d\u8cac\u4e8b\u9805","text":"<p>\u3053\u306e\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u306e\u4f7f\u7528\u306b\u3088\u3063\u3066\u751f\u3058\u305f\u3044\u304b\u306a\u308b\u640d\u5bb3\u306b\u3064\u3044\u3066\u3082\u4f5c\u8005\u306f\u4e00\u5207\u8cac\u4efb\u3092\u8ca0\u3044\u307e\u305b\u3093\u3002</p>"},{"location":"#_2","title":"\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8","text":"<p>Virty\u306f\u7ba1\u7406\u4e88\u5b9a\u306e\u30ce\u30fc\u30c9\u4e0a\u3067\u3082\u3001\u624b\u5143\u306ePC\u3067\u3082\u904b\u7528\u3067\u304d\u307e\u3059\u3002</p> <ol> <li> <p>Docker\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3000\u203b\u30b3\u30f3\u30c6\u30ca\u304c\u8d77\u52d5\u3067\u304d\u308c\u3070Docker\u3067\u3042\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093</p> </li> <li> <p>Docker compose\u3092\u4f7f\u7528\u3057\u305fVirty\u306e\u8d77\u52d5</p> </li> </ol> <pre><code>mkdir virty\ncd virty\nwget https://raw.githubusercontent.com/hibiki31/virty/refs/heads/master/compose.example.yml -O compose.yml\ndocker compose up -d\n</code></pre> <ol> <li>\u30d6\u30e9\u30a6\u30b6\u3067\u3001<code>http://localhost:8765</code>\u307e\u305f\u306f\u3001<code>http://IP:8765</code>\u3078\u30a2\u30af\u30bb\u30b9\u3000\u203b\u30c7\u30d5\u30a9\u30eb\u30c8\u30670.0.0.0\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u307e\u3059</li> </ol> <p>\u8a73\u7d30\u306f\u6700\u5c0f\u69cb\u6210\u3067\u306e\u69cb\u7bc9\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"#_3","title":"\u30b3\u30f3\u30bb\u30d7\u30c8","text":"<p>\u3082\u3068\u3082\u3068\u306f\u3001\u4e3b\u50ac\u3059\u308b\u30b3\u30f3\u30c6\u30b9\u30c8\u3084\u8b1b\u7fa9\u3067\u63d0\u4f9b\u3059\u308bVM\u306e\u4f5c\u6210\u306b\u5229\u7528\u3057\u3066\u3044\u305f\u30b3\u30fc\u30c9\u3092\u3001\u30aa\u30fc\u30d7\u30f3\u30bd\u30fc\u30b9\u3068\u3057\u3066\u516c\u958b\u3057\u307e\u3057\u305f\u3002</p> <ol> <li>\u4eee\u60f3\u30de\u30b7\u30f3\u306e\u5229\u7528\u8005\u3001\u7ba1\u7406\u8005\u3001\u4e21\u65b9\u304c\u5229\u7528\u3057\u3084\u3059\u3044WEB\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9</li> <li>\u3059\u3050\u306b\u7acb\u3066\u3066\u3001\u3059\u3050\u306b\u58ca\u305b\u308b\u3001\u96d1\u306b\u6271\u3063\u3066\u3082\u58ca\u308c\u306a\u3044\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9</li> <li>Python\u30b9\u30af\u30ea\u30d7\u30c8\u7b49\u304b\u3089API\u3092\u53e9\u3044\u3066\u540c\u3058\u5f62\u5f0f\u306eVM\u3092\u4e00\u62ec\u4f5c\u6210\u3067\u304d\u308b</li> <li>VMware ESXi\u306e\u3088\u3046\u306a\u4f7f\u7528\u611f\u3067\u8907\u6570\u306e\u30b5\u30fc\u30d0\u3092\u7ba1\u7406\u3067\u304d\u308b</li> </ol>"},{"location":"dev/reference/","title":"Reference","text":""},{"location":"dev/reference/#api","title":"API","text":"<ol> <li>Libvirt Network</li> </ol>"},{"location":"dev/reference/#web","title":"WEB","text":"<ol> <li>\u30b5\u30fc\u30d3\u30b9\u306e\u30a2\u30a4\u30b3\u30f3</li> <li>\u30b3\u30fc\u30c9\u30cf\u30a4\u30e9\u30a4\u30c8</li> </ol>"},{"location":"dev/reference/#mkdocs","title":"MkDocs","text":"<ol> <li>Material for MkDocs</li> <li>MkDocs\u306b\u3088\u308b\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u4f5c\u6210</li> <li>Shields.io\u3067\u4f5c\u3063\u305f\u30d0\u30c3\u30b8\u306b\u30ea\u30f3\u30af\u3092\u3064\u3051\u308b(Markdown)</li> </ol>"},{"location":"dev/repo/","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u5c65\u6b74","text":""},{"location":"dev/repo/#_2","title":"\u30b3\u30f3\u30bb\u30d7\u30c8\u30b3\u30fc\u30c9\u306e\u524a\u9664","text":"<p>https://github.com/hibiki31/virty/pull/133/files</p> <p>v5.0.1\u306e\u30bf\u30a4\u30df\u30f3\u30b0\u3067\u30b3\u30fc\u30c9\u3092\u6574\u7406</p> <ul> <li>Example\u30b9\u30af\u30ea\u30d7\u30c8</li> <li>Agent (go)</li> <li>Agent (Python)</li> <li>Client (go)</li> <li>Client (Python)</li> <li>Flask\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8</li> <li>Vue2\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3</li> <li>Next\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3</li> <li>API\u65e7Worker</li> <li>pylib</li> <li>nginx</li> </ul>"},{"location":"dev/version/","title":"\u30d0\u30fc\u30b8\u30e7\u30f3\u5c65\u6b74","text":""},{"location":"dev/version/#v008","title":"v0.0.8","text":"<ul> <li>CenOS 8\u30d9\u30fc\u30b9</li> <li>Flask Bootstrap</li> <li>sqlite3</li> </ul> <p>Note</p> <p>2025\u5e746\u670822\u65e5 \u52d5\u4f5c\u78ba\u8a8d - Version 0.0.8 release - c9df3ad49b22da02a582aecbabb4815b329fa7aa</p> <p><code>docker/virty-nginx/Dockerfile</code>\u3068<code>/home/akane/virty/docker/virty-main/Dockerfile</code>\u3092\u7de8\u96c6</p> <pre><code>FROM rockylinux:8.9\n</code></pre> <p><code>/home/akane/virty/docker-compose.yml</code></p> <pre><code>    ports:\n      - \"8989:80\"\n</code></pre> <p>ssh-keygen</p> <pre><code>$ docker exec -it virty-main-1 bash\n[root@078eb1f8e015 main]# ssh-keygen \n</code></pre> <p>DB Initialization</p> <pre><code>http://IP/setup\n</code></pre> <p>500\u304c\u767a\u751f\u3059\u308b\u305f\u3081<code>@login_required</code>\u3092\u5916\u3059</p> <pre><code>VER=0.0.8\ndocker build --no-cache --pull -t hibiki31/virty-api:$VER ./docker/virty-main\ndocker push hibiki31/virty-api:$VER\ndocker build --no-cache --pull -t hibiki31/virty-web:$VER ./docker/virty-nginx\ndocker push hibiki31/virty-web:$VER\n</code></pre>"},{"location":"dev/version/#v161","title":"v1.6.1","text":"<ul> <li>fastapi 0.65.2</li> <li>node 14.19</li> <li>vue 2.6.12</li> </ul> <p>Note</p> <p>2025\u5e746\u670822\u65e5 \u52d5\u4f5c\u78ba\u8a8d - Update v1.6.1 - 183dacdc5bfad872c20bb4097dd08786fd5cc34f</p> <p><code>docker-compose.example.yml</code></p> <pre><code>ports:\n  - \"8989:80\"\n</code></pre> <p>Build\u304c\u5931\u6557\u3059\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u7de8\u96c6 <code>main/requirements.txt</code></p> <pre><code>uvicorn==0.17.0\n</code></pre> <p>ssh-keygen</p> <pre><code>$ docker exec -it virty-virty-main-1 bash\nroot@d13a9cf36698:/opt/virty/app# ssh-keygen \nroot@d13a9cf36698:/opt/virty/app# ssh-copy-id ubuntu@100.64.45.66\n</code></pre> <p>Dockerhub push</p> <pre><code>VER=1.6.1\ndocker build --no-cache --pull -t hibiki31/virty-api:$VER ./main\ndocker push hibiki31/virty-api:$VER\ndocker build --no-cache --pull -t hibiki31/virty-web:$VER ./web\ndocker push hibiki31/virty-web:$VER\n</code></pre>"},{"location":"dev/version/#v230","title":"v2.3.0","text":"<ul> <li>VNC Proxy Console\u5bfe\u5fdc</li> <li>VM\u306e\u30e6\u30fc\u30b6\u3068\u30b0\u30eb\u30fc\u30d7\u306b\u5bfe\u5fdc</li> </ul> <p>Note</p> <p>2025\u5e746\u670822\u65e5 \u52d5\u4f5c\u78ba\u8a8d - Update v2.3.0 - 22b4856cfd0918ff1d4a701680f0471ddf2b0e42</p> <p>up</p> <pre><code>docker compose -f docker-compose.dev.yml up -d\n</code></pre> <p>logs</p> <pre><code>docker compose -f docker-compose.dev.yml logs -f\napi-1    | INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.\napi-1    | INFO  [alembic.runtime.migration] Will assume transactional DDL.\napi-1    | ERROR [alembic.util.messaging] Can't locate revision identified by 'e8ddc480d179'\napi-1    | FAILED: Can't locate revision identified by 'e8ddc480d179'\n</code></pre> <p>db init</p> <pre><code>docker compose -f docker-compose.dev.yml down\ndocker volume rm virty_virty-postgres-data\ndocker volume rm virty_postgres-data\ndocker volume rm virty_api-data\n</code></pre> <p>build up</p> <pre><code>docker compose -f docker-compose.dev.yml build\ndocker compose -f docker-compose.dev.yml up -d\n</code></pre> <p>Dockerhub push</p> <pre><code>VER=2.3.0\ndocker build --no-cache --pull -t hibiki31/virty-api:$VER ./api\ndocker push hibiki31/virty-api:$VER\ndocker build --no-cache --pull -t hibiki31/virty-web:$VER ./web\ndocker push hibiki31/virty-web:$VER\ndocker build --no-cache --pull -t hibiki31/virty-proxy:$VER ./proxy\ndocker push hibiki31/virty-proxy:$VER\n</code></pre>"},{"location":"dev/version/#v303","title":"v3.0.3","text":"<ul> <li>\u30c1\u30b1\u30c3\u30c8\u306e\u6982\u5ff5\u8ffd\u52a0</li> <li>Open vSwitch\u3068\u30dd\u30fc\u30c8\u30b0\u30eb\u30fc\u30d7\u306b\u5bfe\u5fdc</li> <li>Docer hub\u3067\u306e\u30a4\u30e1\u30fc\u30b8\u516c\u958b\u3092\u958b\u59cb</li> <li>Github Action\u3092\u8ffd\u52a0</li> <li>\u4e00\u756a\u9577\u304f\u904b\u7528\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3</li> </ul> <p>Note</p> <p>2025\u5e746\u670822\u65e5 \u52d5\u4f5c\u78ba\u8a8d - Fix can't add portgroup - 7f1ab96a60361361df51e0bc2259611c725c1f0a</p> <p>down</p> <pre><code>docker compose -f docker-compose.dev.yml down \ndocker volume rm virty_virty-postgres-data\n</code></pre> <p>build up</p> <pre><code>docker compose -f docker-compose.dev.yml build\ndocker compose -f docker-compose.dev.yml up -d\n</code></pre> <p>Dockerhub push</p> <pre><code>VER=3.0.3\ndocker build --no-cache --pull -t hibiki31/virty-api:$VER ./api\ndocker push hibiki31/virty-api:$VER\ndocker build --no-cache --pull -t hibiki31/virty-web:$VER ./web\ndocker push hibiki31/virty-web:$VER\ndocker build --no-cache --pull -t hibiki31/virty-proxy:$VER ./proxy\ndocker push hibiki31/virty-proxy:$VER\n</code></pre>"},{"location":"dev/version/#v410","title":"v4.1.0","text":"<ul> <li>WEB\u3092Next\u3067\u5b9f\u88c5</li> <li>API\u306bPagenation\u3001Qeury\u3092\u5b9f\u88c5</li> </ul> <p>Note</p> <p>2025\u5e746\u670822\u65e5 \u52d5\u4f5c\u78ba\u8a8d - 2025/4/25 hibiki31\u4fee\u6b63 \u52d5\u304f   - Merge commit 'e19cbe202909c9e8ea7796cfb9f68bb1cee04156' into develop   - 3ffeb3bdc934ec6b7b2c74b3d41fe5a25127af3a - 2024/6/30 pagenation\u4fee\u6b63 Failed <code>Fix useFormExtraData to store by propertyName</code>   - Merge pull request #118 from hibiki31/update/support-pagination   - 810ad1c051988ac734735f5913d1d9566e4bbe69</p> <p>down</p> <pre><code>docker compose -f docker-compose.dev.yml down \ndocker volume rm virty_virty-postgres-data\n</code></pre> <p>fix <code>docker-compose.dev.yml</code> 2025/6/30\u307e\u3067\u306f\u3053\u306e\u30d0\u30b0\u304c\u5165\u308b</p> <pre><code>    ports: \n      - 0.0.0.0:8765:80\n</code></pre> <p>build up</p> <pre><code>docker compose -f docker-compose.dev.yml build\ndocker compose -f docker-compose.dev.yml up -d\ndocker compose -f docker-compose.dev.yml logs -f\n</code></pre> <p>Failed <code>Fix useFormExtraData to store by propertyName</code>\u3053\u3053\u3067\u30d0\u30b0\u304c\u5165\u308b</p> <pre><code>20.56 Failed to compile.\n20.56 \n20.56 ./components/JtdForm/index.tsx:18:30\n20.56 Type error: Expected 1 arguments, but got 0.\n20.56 \n20.56   16 | export const JtdForm: FC&lt;Props&gt; = ({ prefixPropertyName, propertyJtd, rootJtd, isEditing, isError = false }) =&gt; {\n20.56   17 |   const { reset } = useJtdForm(rootJtd);\n20.56 &gt; 18 |   const { resetExtraData } = useFormExtraData();\n20.56      |                              ^\n20.56   19 | \n20.56   20 |   useEffect(\n20.56   21 |     () =&gt; () =&gt; {\n------\nfailed to solve: process \"/bin/sh -c yarn build\" did not complete successfully: exit code: 1\n</code></pre> <p>2025/4/25\u6642\u70b9\u306eAPI\u3060\u30685.0.0\u306b\u306a\u3063\u3066\u3044\u308b\u3002<code>Merge pull request #102 from hibiki31/fix/vm-network-ovs</code>\u3067\u306f4.1.0\u3067\u3042\u308b\u3002</p> <p>fix <code>next/lib/api/index.ts</code> env\u304c\u4e0a\u624b\u304f\u6a5f\u80fd\u3057\u3066\u3044\u306a\u3044\u306e\u3067\u4ee5\u4e0b\u306e\u4fee\u6b63\u3092\u884c\u3046\u3002push\u6642\u306f\u6d88\u3059\u3002</p> <pre><code>const config = new Configuration({\n  basePath: \"http://100.81.114.103:8765\",\n  accessToken: () =&gt; {\n    const { token } = parseCookies();\n    return token;\n  },\n});\n</code></pre> <p>Dockerhub push</p> <pre><code>VER=4.1.0\ndocker build --no-cache --pull -t hibiki31/virty-api:$VER ./api\ndocker push hibiki31/virty-api:$VER\ndocker build --no-cache --pull -t hibiki31/virty-web:$VER ./next\ndocker push hibiki31/virty-web:$VER\ndocker build --no-cache --pull -t hibiki31/virty-proxy:$VER ./proxy\ndocker push hibiki31/virty-proxy:$VER\n</code></pre> <p>Clean</p> <pre><code>docker compose -f docker-compose.dev.yml down\ndocker volume rm virty_postgres-data \n</code></pre>"},{"location":"example/expoter/","title":"Expoter","text":"<p>Virty\u306fPrometheus\u5411\u3051\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u3068\u3057\u3066\u4ee5\u4e0b\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p> <ul> <li>Web\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306eIP/metrics</li> <li>\u30bf\u30b9\u30af\u306e\u5b9f\u65bd\u72b6\u6cc1</li> <li>\u30e1\u30e2\u30ea\u306e\u7dcf\u4e88\u7d04\u91cf</li> <li>\u30b3\u30a2\u6570\u306e\u7dcf\u4e88\u7d04\u91cf</li> <li>\u30ce\u30fc\u30c9\u306e\u6570</li> </ul> <p>\u4eee\u60f3\u30de\u30b7\u30f3\u3054\u3068\u306e\u30e1\u30c8\u30ea\u30af\u30b9\u306f\u4ee5\u4e0b\u306eOSS\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u5b9f\u73fe\u3057\u307e\u3059\u3002 inovex GmbH\u306b\u611f\u8b1d\u3057\u307e\u3059\u3002</p> <p>inovex/prometheus-libvirt-exporter</p>"},{"location":"example/expoter/#expoter_1","title":"\u30ce\u30fc\u30c9\u3078\u306eExpoter\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb","text":"<p>Github\u306e\u30ea\u30ea\u30fc\u30b9\u30da\u30fc\u30b8\u306b\u30a2\u30af\u30bb\u30b9\u3057\u307e\u3059\u3002 \u6700\u65b0\u306e\u30a4\u30e1\u30fc\u30b8ID\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3059\u3002</p> <pre><code>mkdir prometheus-libvirt-exporter\ncd prometheus-libvirt-exporter\n</code></pre> <p><code>compose.yaml</code>\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>services:\n  expoter:\n    image: ghcr.io/inovex/prometheus-libvirt-exporter:2.1.1-amd64\n    volumes:\n      - /var/run/libvirt/libvirt-sock-ro:/var/run/libvirt/libvirt-sock-ro:ro\n    ports:\n      - 9177:9177\n    restart: always\n</code></pre> <p>Note</p> <p><code>docker run --rm ghcr.io/inovex/prometheus-libvirt-exporter:2.1.1-amd64 -h</code>\u3067\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002</p> <pre><code>docker compose up -d\n</code></pre>"},{"location":"example/expoter/#prometheus","title":"Prometheus\u306b\u8a2d\u5b9a\u3092\u8ffd\u52a0","text":"<ul> <li>192.168.10.1\u306f\u30ce\u30fc\u30c9\u306eIP\u3067\u3059</li> <li>192.168.10.200\u306fvirty\u306eIP\u3067\u3059</li> </ul> <p>Note</p> <p>\u4e0a\u8a18\u306eIP\u306f\u540c\u3058\u3068\u306a\u308b\u30b1\u30fc\u30b9\u3082\u3042\u308a\u307e\u3059</p> <pre><code>  - job_name: 'libvirt'\n    scrape_interval: 10s\n    metrics_path: /metrics\n    static_configs:\n      - targets:\n        - '192.168.10.1:9177'\n  - job_name: 'virty-fastapi'\n    scrape_interval: 10s\n    metrics_path: /api/metrics-fastapi\n    static_configs:\n      - targets:\n        - '192.168.10.200:8765'\n  - job_name: 'virty-api'\n    scrape_interval: 10s\n    metrics_path: /api/metrics\n    static_configs:\n      - targets:\n        - '192.168.10.200:8765'\n</code></pre> <p>Grafana\u3067\u53ef\u8996\u5316\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3092\u5229\u7528\u3057\u307e\u3059\u3002</p> <p>https://grafana.com/grafana/dashboards/20737-libvirt-dashboard/</p> <p>Note</p> <p>\u3053\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306f\u4ee5\u4e0b\u306eIssue\u3067\u8b70\u8ad6\u3055\u308c\u3066\u3044\u308b\u901a\u308a\u3001\u8ca2\u732e\u8005\u306ePR\u5f85\u3061\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3067\u3059\u3002\u4eee\u3067\u3042\u308a\u3001\u516c\u5f0f\u306e\u3082\u306e\u3067\u306f\u306a\u3044\u3053\u3068\u306b\u6ce8\u610f\u304c\u5fc5\u8981\u3067\u3059\u3002 https://github.com/inovex/prometheus-libvirt-exporter/issues/17</p> <p>Warning</p> <p>virty\u95a2\u9023\u306e\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306f\u4f5c\u6210\u4e2d\u3067\u3059\u3002</p>"},{"location":"example/frr-vxlan/","title":"FRRouting EVPN/VXLAN","text":"<p>FRRouting\u3092\u4f7f\u7528\u3057\u3066VM\u7528\u30b5\u30d6\u30cd\u30c3\u30c8\u3092\u8907\u6570\u30ce\u30fc\u30c9\u3067L2\u5ef6\u4f38(EVPN/VXLAN)\u3059\u308b</p> <p>Note</p> <p>\u4f5c\u6210\u4e2d</p>"},{"location":"example/frr/","title":"FRRouting BGP","text":"<p>FRRouting\u3092\u4f7f\u7528\u3057\u3066VM\u7528\u30b5\u30d6\u30cd\u30c3\u30c8\u3092BGP\u5e83\u544a\u3059\u308b</p> <p>Note</p> <p>\u4f5c\u6210\u4e2d</p>"},{"location":"example/netbox/","title":"NetBox","text":"<p>Note</p> <p>\u4f5c\u6210\u4e2d</p>"},{"location":"example/python_script/","title":"Python Scirpts","text":"<p>Python\u30b9\u30af\u30ea\u30d7\u30c8\u304b\u3089Virty API\u3092\u53e9\u3044\u3066VM\u3092\u4e00\u6c17\u306b\u4f5c\u6210\u3059\u308bTips\u3067\u3059\u3002\u30ce\u30fc\u30c9\u306e\u8ffd\u52a0\u3001\u30b9\u30c8\u30ec\u30fc\u30b8\u306e\u8ffd\u52a0\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u8ffd\u52a0\u306a\u3069\u304c\u5b8c\u4e86\u3057\u3066\u304a\u308a\u3001\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089VM\u304c\u4f5c\u308c\u308b\u72b6\u614b\u3092\u60f3\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u6700\u5c0f\u69cb\u6210</p>"},{"location":"example/python_script/#vm","title":"VM\u306e\u4e00\u62ec\u4f5c\u6210","text":"<pre><code>import requests\n\nBASE_URL = 'http://localhost:8765'\nTOKEN = \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"\n\n\ndef main():\n    servers = [\n        [\"dev-nuxt-server\",      \"192.168.19.1/24\"],\n        [\"prod-nuxt-server\",     \"192.168.19.2/24\"],\n        [\"prac-apache-server\",   \"192.168.19.3/24\"],\n        [\"dev-django-server\",    \"192.168.19.4/24\"],\n        [\"prod-django-server\",   \"192.168.19.5/24\"],\n    ]\n\n    for i in servers:\n        create_vm(\n            # Spec\n            vm_name    = i[0],\n            node_name  = \"node-02\",\n            core= 8,\n            memory= 16,\n\n            # Storage\n            src_sotrage_uuid=\"4df226bb-1a73-4d47-990d-xxxxxxxxxxxx\",\n            dst_storage_uuid=\"2ab906b3-8f19-4018-b542-xxxxxxxxxxxx\",\n            copy_image=\"noble-server-cloudimg-amd64.img\",\n            disk_size=128,\n\n            # Login\n            login_user=\"user\",\n            login_pw=\"password\",\n            pubkey=\"ssh-ed25519 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\",\n\n            # Network\n            ip_address=i[1],\n            gateway=\"192.168.19.254\",\n            nameserver=\"1.1.1.1\",\n            network_uuid=\"bec29dff-21ed-46c1-a526-xxxxxxxxxxxx\",\n        )\n\n\n\ndef create_vm(vm_name, node_name, core, memory, src_sotrage_uuid, dst_storage_uuid, copy_image, disk_size, network_uuid, login_user, login_pw, pubkey, ip_address, gateway, nameserver):\n    userData = f\"\"\"\n#cloud-config\npassword: {login_pw}\nchpasswd: {{expire: False}}\nuser: {login_user}\nssh_pwauth: True\nssh_authorized_keys:\n  - {pubkey}\ntimezone: \"Asia/Tokyo\"\nwrite_files:\n  - path: /etc/netplan/50-cloud-init.yaml\n    owner: root:root\n    permissions: '0644'\n    content: |\n      network:\n        ethernets:\n            ens3:\n                dhcp4: false\n                addresses:\n                - {ip_address}\n                routes:\n                - to: default\n                  via: {gateway}\n                nameservers:\n                  addresses:\n                  - {nameserver}\n        version: 2\nruncmd:\n  - [ netplan, apply ]\n\"\"\"\n\n    request_data = {\n        \"type\": \"manual\",\n        \"name\": vm_name,\n        \"nodeName\":node_name,\n        \"memoryMegaByte\": memory*1024,\n        \"cpu\":core,\n        \"disks\":[\n            {\n                \"id\":1,\n                \"type\":\"copy\",\n                \"savePoolUuid\": dst_storage_uuid,\n                \"originalPoolUuid\": src_sotrage_uuid,\n                \"originalName\": copy_image,\n                \"sizeGigaByte\": disk_size\n            }\n        ],\n        \"interface\":[\n            {\n                \"type\":\"network\",\n                \"networkUuid\":network_uuid,\n            }\n        ],\n        \"cloudInit\":{\n            \"hostname\": vm_name,\n            \"userData\": userData\n        }\n    }\n    res = requests.request(method=\"post\",url=f'{BASE_URL}/api/tasks/vms', headers=HEADERS, json=request_data)\n    print(f\"CreateVM: {res.status_code}\")\n\n\n\nHEADERS = {\n    \"accept\": \"application/json, text/plain, */*\",\n    \"accept-language\": \"ja\",\n    \"authorization\": f\"Bearer {TOKEN}\",\n}\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"example/python_script/#vm_1","title":"VM\u306e\u4e00\u62ec\u524a\u9664","text":"<pre><code>import requests\n\nBASE_URL = 'http://localhost:8765'\nTOKEN = \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"\n\n\ndef main():\n    deletion_match = \"test-\"\n\n    vms = requests.get(f\"{BASE_URL}/api/vms?admin=true\",headers=HEADERS).json()\n\n    for vm in vms[\"data\"]:\n        if deletion_match in vm[\"name\"]:\n            print(\"Delete VM: \",vm[\"uuid\"], vm[\"name\"])\n\n            delete_uuid = vm[\"uuid\"]\n            requests.delete(f'{BASE_URL}/api/tasks/vms/{delete_uuid}', headers=HEADERS)\n\nHEADERS = {\n    \"accept\": \"application/json, text/plain, */*\",\n    \"accept-language\": \"ja\",\n    \"authorization\": f\"Bearer {TOKEN}\",\n}\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"example/python_script/#vmon","title":"VM\u306e\u4e00\u62ecON","text":"<pre><code>import requests\n\nBASE_URL = 'http://localhost:8765'\nTOKEN = \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"\n\n\ndef main():\n    poweron_match = \"-\"\n\n    vms = requests.get(f\"{BASE_URL}/api/vms?admin=true\",headers=HEADERS).json()\n\n    for vm in vms[\"data\"]:\n        if poweron_match in vm[\"name\"]:\n            res = requests.patch(f'{BASE_URL}/api/tasks/vms/{vm[\"uuid\"]}/power', headers=HEADERS, json={\"status\": \"on\"})\n            print(\"PowerON VM: \", res.status_code, vm[\"uuid\"], vm[\"name\"])\n\nHEADERS = {\n    \"accept\": \"application/json, text/plain, */*\",\n    \"accept-language\": \"ja\",\n    \"authorization\": f\"Bearer {TOKEN}\",\n}\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"example/tailscale/","title":"Tailscale","text":"<p>Tailscale subnet router\u3068\u9023\u643a\u3057\u3001Virty\u3067\u4f5c\u6210\u3057\u305fNW\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <p>Note</p> <p>Tailscale\u30a2\u30ab\u30a6\u30f3\u30c8\u306e\u767b\u9332\u3001\u30b5\u30fc\u30d0\u306e\u8ffd\u52a0\u306f\u5b8c\u4e86\u3057\u3066\u3044\u308b\u524d\u63d0\u3067\u8a18\u8f09</p>"},{"location":"example/tailscale/#subnetrouter","title":"Subnetrouter","text":"<p>Tailscale\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</p> <p>IP\u8ee2\u9001\u3092\u6709\u52b9\u306b\u3059\u308b</p> <pre><code>echo 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.d/99-tailscale.conf\necho 'net.ipv6.conf.all.forwarding = 1' | sudo tee -a /etc/sysctl.d/99-tailscale.conf\nsudo sysctl -p /etc/sysctl.d/99-tailscale.conf\n</code></pre> <p>\u30b5\u30d6\u30cd\u30c3\u30c8\u3092\u30a2\u30c9\u30d0\u30bf\u30a4\u30ba\u3059\u308b</p> <pre><code>sudo tailscale set --advertise-routes=192.168.0.0/24,10.0.0.0/16\n</code></pre> <p>Note</p> <p>virty\u3067\u4f5c\u6210\u4e88\u5b9a\u306e\u30b5\u30d6\u30cd\u30c3\u30c8\u304c\u542b\u307e\u308c\u308b\u3088\u3046\u306b\u3001\u3042\u3089\u304b\u3058\u3081/16\u7b49\u5927\u304d\u304f\u5e83\u544a\u3059\u308b\u3053\u3068\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\u3002\u305d\u3046\u3059\u308c\u3070\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306710.0.3.0/24\u306a\u3069\u3092\u8ffd\u52a0\u3057\u305f\u969b\u3001\u30ce\u30fc\u30c9\u4e0a\u3067\u30a2\u30c9\u30d0\u30bf\u30a4\u30ba\u3001Tailscale\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3067\u627f\u8a8d\u3059\u308b\u4f5c\u696d\u304c\u4e0d\u8981\u306b\u306a\u308a\u307e\u3059\u3002</p>"},{"location":"example/tailscale/#_1","title":"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u4f5c\u6210","text":"<p>virty\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u3067<code>route</code>\u30e2\u30fc\u30c9\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u4ee5\u4e0a\u3067Tailscale\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u7d4c\u7531\u3057\u305f\u30a2\u30af\u30bb\u30b9\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002</p> <p>Warning</p> <p>\u30a2\u30af\u30bb\u30b9\u304c\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u3001\u30ce\u30fc\u30c9\u306e\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3001Tailscale ACL\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"example/tailscale/#_2","title":"\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a","text":"<p>\u73fe\u6642\u70b9\u3067\u306f\u3001tailscale\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u7d4c\u7531\u3067VM\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u3067\u3059\u304c\u3001VM\u306f\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u51fa\u308c\u307e\u305b\u3093\u3002Routeing/NAT\u306e2\u7a2e\u985e\u3067VM\u306b\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u63a5\u7d9a\u3092\u63d0\u4f9b\u3067\u304d\u307e\u3059\u3002</p> <p>Warning</p> <p>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u540c\u58eb\u306e\u63a5\u7d9a\u306a\u3069\u3001Linux\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3001\u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3092\u8003\u616e\u3057\u3066\u9069\u5207\u306b\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"},{"location":"example/tailscale/#routing","title":"Routing","text":"<p>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092<code>route</code>\u30e2\u30fc\u30c9\u3067\u4f5c\u6210\u3059\u308b\u3068\u3001\u30ce\u30fc\u30c9\u4e0a\u306bL2\u4eee\u60f3\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u3001\u30ce\u30fc\u30c9\u304c\u63a5\u7d9a\u3059\u308b\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u7b49\u306b\u767b\u9332\u3059\u308c\u3070\u4e00\u822c\u7684\u306aL3\u30eb\u30fc\u30c6\u30a3\u30f3\u30b0\u3067\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u51fa\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>GW\u306b\u767b\u9332\u3059\u308b\u30b5\u30d6\u30cd\u30c3\u30c8: \u4f5c\u6210\u3057\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af/\u4f5c\u6210\u4e88\u5b9a\u306e\u30b5\u30d6\u30cd\u30c3\u30c8\u7bc4\u56f2 (\u4f8b 10.0.0.0/16)\nGW\u306b\u767b\u9332\u3059\u308b\u30cd\u30af\u30b9\u30c8\u30db\u30c3\u30d7: \u30ce\u30fc\u30c9\u306eIP\u30a2\u30c9\u30ec\u30b9(\u4f8b 192.168.0.10)\u3000\n</code></pre>"},{"location":"example/tailscale/#nat","title":"NAT","text":"<p>\u30b2\u30fc\u30c8\u30a6\u30a7\u30a4\u306b\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u304c\u767b\u9332\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u3001\u30ce\u30fc\u30c9\u306eIP\u3092\u7528\u3044\u305fNAPT\u3067\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u63a5\u7d9a\u3067\u304d\u307e\u3059\u3002</p> <p>Warning</p> <p>VM\u306f\u30ce\u30fc\u30c9\u306eIP\u3092\u4f7f\u7528\u3057\u3066\u3001\u30ce\u30fc\u30c9\u304c\u63a5\u7d9a\u3067\u304d\u308b\u3059\u3079\u3066\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u9069\u5207\u306biptables\u3067\u5236\u9650\u3092\u304b\u3051\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002</p> <p>\u4f5c\u6210\u3057\u305f\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306e\u30b5\u30d6\u30cd\u30c3\u30c8\u304c<code>10.0.0.0/16</code>\u3001\u30a4\u30f3\u30bf\u30fc\u30cd\u30c3\u30c8\u306b\u51fa\u308c\u308b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9<code>enp0s9</code></p> <pre><code>sudo iptables -t nat -A POSTROUTING -s 10.0.0.0/16 -o enp0s9 -j MASQUERADE \n</code></pre>"},{"location":"setup/ceph/","title":"Ceph Storage","text":"<p>Note</p> <p>\u4f5c\u6210\u4e2d</p>"},{"location":"setup/minimum/","title":"\u6700\u5c0f\u69cb\u6210","text":"<p>Note</p> <p>\u4f5c\u6210\u4e2d</p>"},{"location":"setup/nginx/","title":"opt. Nginx(SSL)","text":"<p>Note</p> <p>\u4f5c\u6210\u4e2d</p>"},{"location":"setup/vlan/","title":"Open vSwitch VLAN","text":"<p>Open vSwitch\u3092\u5229\u7528\u3057\u3066\u3001VM\u306b\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u304b\u3089VLAN\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u30ce\u30fc\u30c9\u4e0a\u3067\u306e\u4f5c\u696d\u306f\u4ee5\u4e0b\u306e\u69cb\u7bc9\u4f5c\u696d1\u56de\u3060\u3051\u3067\u3059\u3002</p>"},{"location":"setup/vlan/#_1","title":"\u8a2d\u5b9a\u5185\u5bb9","text":"<p>\u30ce\u30fc\u30c9\u306eNIC\u304c1\u3064\u306e\u30b1\u30fc\u30b9\u3067\u3001\u7ba1\u7406\u7528\uff08\u30db\u30b9\u30c8\u306bSSH\u3057\u305f\u308aVirty\u3078\u30a2\u30af\u30bb\u30b9\u3057\u305f\u308a\uff09\u3068\u3057\u3066\u3082\u4f7f\u3063\u3066\u3044\u308b\u60f3\u5b9a\u3067\u3059\u3002</p> <p></p> <p>\u4eca\u56de\u306e\u8a2d\u5b9a\u5024\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002</p> name value Bridge name ovs-br0 Physical interface eth0 Native VLAN 100 VLAN to Host IP 200 Host IP 192.168.200.1 <p>Note</p> <p>\u308f\u304b\u308a\u3084\u3059\u304f\u3059\u308b\u305f\u3081\u3001Native VLAN\u3084\u30db\u30b9\u30c8\u7528VLAN\u306e\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002\u666e\u901a\u306b\u4e21\u65b91\u306e\u30b1\u30fc\u30b9\u306e\u307b\u3046\u304c\u591a\u3044\u3068\u601d\u3044\u307e\u3059\u3002</p>"},{"location":"setup/vlan/#_2","title":"\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb","text":"<pre><code>sudo apt update\nsudo apt install openvswitch-common openvswitch-switch\nsudo systemctl status openvswitch-switch.service\n</code></pre>"},{"location":"setup/vlan/#_3","title":"\u30d6\u30ea\u30c3\u30b8\u306e\u4f5c\u6210","text":"<p>Danger</p> <p>\u3053\u306e\u624b\u9806\u3092\u666e\u901a\u306b\u5b9f\u65bd\u3059\u308b\u3068\u3001\u7ba1\u7406\u7528\u306eIP\u304c\u4e00\u6642\u7684\u306b\u5229\u7528\u3067\u304d\u306a\u304f\u306a\u308b\u306e\u3067SSH\u304c\u9014\u5207\u308c\u307e\u3059\u3002\u56f0\u308b\u5834\u5408\u306f<code>\u30d6\u30ea\u30c3\u30b8\u306e\u4f5c\u6210(\u7121\u505c\u6b62)</code>\u3092\u5b9f\u65bd\u3057\u3066\u304f\u3060\u3055\u3044\u3002<code>\u30d6\u30ea\u30c3\u30b8\u306e\u4f5c\u6210(\u7121\u505c\u6b62)</code>\u306f\u8aac\u660e\u3092\u7c21\u7565\u5316\u3057\u3066\u3044\u308b\u306e\u3067\u3001\u5b9f\u65bd\u306e\u6d41\u308c\u306f\u3053\u3061\u3089\u3092\u78ba\u8a8d\u306e\u4e0a\u884c\u3063\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>sudo ovs-vsctl add-br ovs-br0\nsudo ovs-vsctl add-port ovs-br0 eth0\n</code></pre> <p>\u30db\u30b9\u30c8\u304c\u5229\u7528\u3059\u308bNIC\u306bVLAN\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u5229\u7528\u3057\u306a\u3044\u5834\u5408\u306f\u5b9f\u884c\u3057\u306a\u3044\u3067\u304f\u3060\u3055\u3044\u3002</p> <pre><code>sudo ovs-vsctl set port ovs-br0 tag=200 \n</code></pre> <p>eth0\u306eNative VLAN\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\u63a5\u7d9a\u3059\u308b\u30b9\u30a4\u30c3\u30c1\u306e\u30c8\u30e9\u30f3\u30af\u8a2d\u5b9a\u306a\u3069\u3092\u78ba\u8a8d\u3057\u3066\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>sudo ovs-vsctl set port eth0 tag=100 vlan_mode=native-untagged\n</code></pre> <p>\u8a2d\u5b9a\u5185\u5bb9\u306e\u78ba\u8a8d</p> <pre><code>ovs-vsctl show\n</code></pre> <p>eth0\u306b\u8a2d\u5b9a\u3057\u3066\u3044\u305fnetplan\u306e\u8a2d\u5b9a\u5185\u5bb9\u3092\u305d\u306e\u307e\u307eovs-br0\u306b\u8a18\u8f09\u3057\u307e\u3059\u3002\u3053\u306eovs-br\u304c\u30db\u30b9\u30c8\u7528\u306eNIC\u3068\u3057\u3066\u5229\u7528\u3055\u308c\u307e\u3059\u3002(ex. SSH, Virty)</p> <pre><code>network:\n  ethernets:\n    eth0:\n      dhcp4: false\n    ovs-br0:\n      dhcp4: false\n      addresses:\n        - 192.168.200.1/24\n      gateway4: 192.168.200.254\n      nameservers:\n        addresses: [ 192.168.200.254 ]\n  version: 2\n</code></pre> <p>\u8a2d\u5b9a\u3092\u9069\u5fdc\u3057\u307e\u3059\u3002</p> <pre><code>sudo netplan apply\n</code></pre>"},{"location":"setup/vlan/#_4","title":"\u30d6\u30ea\u30c3\u30b8\u306e\u4f5c\u6210(\u7121\u505c\u6b62)","text":"<p>Danger</p> <p>\u3053\u306e\u624b\u9806\u3092\u666e\u901a\u306b\u5b9f\u65bd\u3059\u308b\u3068\u3001\u60f3\u5b9a\u901a\u308a\u3067\u3042\u308c\u3070\u3001\u518d\u3073SSH\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u5931\u6557\u3059\u308b\u3068SSH\u63a5\u7d9a\u304c\u3067\u304d\u306a\u304f\u306a\u308b\u305f\u3081\u7d30\u5fc3\u306e\u6ce8\u610f\u3092\u6255\u3063\u3066\u304f\u3060\u3055\u3044\u3002</p> <p>netplan\u306e\u8a2d\u5b9a\u79fb\u690d</p> <pre><code>network:\n  ethernets:\n    eth0:\n      dhcp4: false\n    ovs-br0:\n      dhcp4: false\n      addresses:\n        - 192.168.200.1/24\n      gateway4: 192.168.200.254\n      nameservers:\n        addresses: [ 192.168.200.254 ]\n  version: 2\n</code></pre> <p>Warning</p> <p>MAC\u30a2\u30c9\u30ec\u30b9\u306e\u4e00\u81f4\u30eb\u30fc\u30eb\u306a\u3069\u304c\u66f8\u3044\u3066\u3042\u308b\u3068\u5931\u6557\u3059\u308b\u306e\u3067\u6ce8\u610f <pre><code>network:\n    version: 2\n    ethernets:\n        ens3:\n        match:\n            macaddress: \"00:16:3e:2c:c8:2e\"\n        dhcp4: true\n        dhcp6: true\n        set-name: \"ens3\"\n</code></pre></p> <p>netplan\u306e\u8a2d\u5b9a\u78ba\u8a8d(\u69cb\u6587\u30c1\u30a7\u30c3\u30af)</p> <pre><code>sudo netplan generate\n</code></pre> <p>\u5148\u306b\u5b9f\u65bd\u3067\u304d\u308b\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c</p> <pre><code>sudo ovs-vsctl add-br ovs-br0\nsudo ovs-vsctl set port ovs-br0 tag=200 \n</code></pre> <p>\u4e00\u62ec\u3067\u5b9f\u884c</p> <pre><code>sudo ovs-vsctl add-port ovs-br0 eth0; sudo ovs-vsctl set port eth0 tag=100 vlan_mode=native-untagged; sudo netplan apply\n</code></pre>"}]}